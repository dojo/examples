{"version":3,"sources":["webpack://realworld_app/./src/processes/profileProcesses.ts","webpack://realworld_app/./src/widgets/Profile.tsx"],"names":["startGetProfileCommand","Object","utils","path","operations","undefined","startGetProfileFeedCommand","payload","page","type","followUserCommand","async","get","username","following","token","response","fetch","config","method","headers","json","profile","getProfileCommand","image","bio","getProfileFeedCommand","offset","url","articles","articlesCount","getProfileProcess","process","getProfileFeedProcess","followUserProcess","__webpack_require__","d","__webpack_exports__","Profile_Profile","vdom","store","src_store","properties","factory","middleware","executor","isLoading","profileUser","feed","currentUser","category","isCurrentUser","currentPage","total","classes","src","Link","to","onclick","ActiveLink","params","activeClasses","FeedList","items","FeedPagination","fetchFeed"],"mappings":"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","file":"src/widgets/Profile.41c431184c649a3b0bdb.bundle.js","sourcesContent":["import { createProcess } from '@dojo/framework/stores/process';\nimport { replace } from '@dojo/framework/stores/state/operations';\nimport { getHeaders, commandFactory } from './utils';\nimport { baseUrl } from '../config';\nimport { FollowUserPayload } from './interfaces';\n\nconst startGetProfileCommand = commandFactory(({ path }) => {\n\treturn [\n\t\treplace(path('profile', 'user', 'isLoading'), true),\n\t\treplace(path('profile', 'user', 'isLoaded'), false),\n\t\treplace(path('profile', 'feed', 'items'), undefined)\n\t];\n});\n\nconst startGetProfileFeedCommand = commandFactory(({ path, payload: { page, type } }) => {\n\treturn [\n\t\treplace(path('profile', 'feed', 'isLoading'), true),\n\t\treplace(path('profile', 'feed', 'isLoaded'), false),\n\t\treplace(path('profile', 'feed', 'category'), type),\n\t\treplace(path('profile', 'feed', 'page'), page)\n\t];\n});\n\nconst followUserCommand = commandFactory<FollowUserPayload>(async ({ get, path, payload: { username, following } }) => {\n\tconst token = get(path('session', 'token'));\n\tconst response = await fetch(`${baseUrl}/profiles/${username}/follow`, {\n\t\tmethod: following ? 'delete' : 'post',\n\t\theaders: getHeaders(token)\n\t});\n\tconst json = await response.json();\n\n\treturn [replace(path('profile'), json.profile)];\n});\n\nconst getProfileCommand = commandFactory<{ username: string; type: string }>(\n\tasync ({ get, path, payload: { username } }) => {\n\t\tconst token = get(path('session', 'token'));\n\t\tconst response = await fetch(`${baseUrl}/profiles/${username}`, {\n\t\t\theaders: getHeaders(token)\n\t\t});\n\t\tconst json = await response.json();\n\n\t\treturn [\n\t\t\treplace(path('profile', 'user', 'username'), json.profile.username),\n\t\t\treplace(path('profile', 'user', 'image'), json.profile.image),\n\t\t\treplace(path('profile', 'user', 'bio'), json.profile.bio),\n\t\t\treplace(path('profile', 'user', 'following'), json.profile.following),\n\t\t\treplace(path('profile', 'user', 'isLoading'), false),\n\t\t\treplace(path('profile', 'user', 'isLoaded'), true)\n\t\t];\n\t}\n);\n\nconst getProfileFeedCommand = commandFactory<{ username: string; type: string; page: number }>(\n\tasync ({ get, path, payload: { type, username, page } }) => {\n\t\tconst token = get(path('session', 'token'));\n\t\tconst offset = page * 10;\n\t\tlet url = `${baseUrl}/articles?`;\n\n\t\tswitch (type) {\n\t\t\tcase 'favorites':\n\t\t\t\turl = `${url}favorited=${username}&`;\n\t\t\t\tbreak;\n\t\t\tcase 'user':\n\t\t\t\turl = `${url}author=${username}&`;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst response = await fetch(`${url}limit=10&offset=${offset}`, { headers: getHeaders(token) });\n\t\tconst json = await response.json();\n\t\treturn [\n\t\t\treplace(path('profile', 'feed', 'items'), json.articles),\n\t\t\treplace(path('profile', 'feed', 'total'), json.articlesCount),\n\t\t\treplace(path('profile', 'feed', 'offset'), offset),\n\t\t\treplace(path('profile', 'feed', 'isLoading'), false),\n\t\t\treplace(path('profile', 'feed', 'isLoaded'), true)\n\t\t];\n\t}\n);\n\nexport const getProfileProcess = createProcess('get-profile', [\n\t[startGetProfileCommand, startGetProfileFeedCommand],\n\t[getProfileCommand, getProfileFeedCommand]\n]);\nexport const getProfileFeedProcess = createProcess('get-profile-feed', [\n\tstartGetProfileFeedCommand,\n\tgetProfileFeedCommand\n]);\nexport const followUserProcess = createProcess('follow-user', [followUserCommand]);\n","import { create, tsx } from '@dojo/framework/core/vdom';\nimport { Link } from '@dojo/framework/routing/Link';\nimport { ActiveLink } from '@dojo/framework/routing/ActiveLink';\nimport FeedList from './FeedList';\nimport store from '../store';\nimport { getProfileFeedProcess, getProfileProcess, followUserProcess } from '../processes/profileProcesses';\nimport { FeedPagination } from './FeedPagination';\n\nexport interface ProfileProperties {\n\tusername: string;\n\ttype: string;\n}\n\nconst factory = create({ store }).properties<ProfileProperties>();\n\nexport const Profile = factory(function Profile({ middleware: { store }, properties }) {\n\tconst { get, path, executor } = store;\n\tconst isLoading = get(path('profile', 'user', 'isLoading'));\n\tconst profileUser = get(path('profile', 'user', 'username'));\n\tconst feed = get(path('profile', 'feed'));\n\tconst currentUser = get(path('session', 'username'));\n\tconst { username, type } = properties();\n\n\tif (username !== profileUser && !isLoading) {\n\t\texecutor(getProfileProcess)({ username, type, page: 0 });\n\t\treturn null;\n\t} else if (type !== feed.category && !feed.isLoading) {\n\t\texecutor(getProfileFeedProcess)({ username, type, page: 0 });\n\t}\n\tconst isCurrentUser = currentUser === profileUser;\n\tconst currentPage = get(path('profile', 'feed', 'page')) || 0;\n\tconst total = get(path('profile', 'feed', 'total')) || 0;\n\tconst image = get(path('profile', 'user', 'image'));\n\tconst bio = get(path('profile', 'user', 'bio'));\n\tconst following = get(path('profile', 'user', 'following'));\n\n\treturn (\n\t\t<div classes={['profile-page']}>\n\t\t\t<div classes={['user-info']}>\n\t\t\t\t<div classes={['container']}>\n\t\t\t\t\t<div classes={['row']}>\n\t\t\t\t\t\t<div classes={['col-xs-12', 'col-md-10', 'offset-md-1']}>\n\t\t\t\t\t\t\t<img src={image} classes={['user-img']} />\n\t\t\t\t\t\t\t<h4>{username}</h4>\n\t\t\t\t\t\t\t<p>{bio}</p>\n\t\t\t\t\t\t\t{isCurrentUser ? (\n\t\t\t\t\t\t\t\t<Link classes={['btn', 'btn-sm', 'btn-outline-secondary', 'action-btn']} to=\"settings\">\n\t\t\t\t\t\t\t\t\t<i classes={['ion-edit']} />\n\t\t\t\t\t\t\t\t\t{' Edit Profile Settings'}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\texecutor(followUserProcess)({\n\t\t\t\t\t\t\t\t\t\t\tfollowing,\n\t\t\t\t\t\t\t\t\t\t\tusername\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tclasses={[\n\t\t\t\t\t\t\t\t\t\t'btn',\n\t\t\t\t\t\t\t\t\t\t'btn-sm',\n\t\t\t\t\t\t\t\t\t\t'action-btn',\n\t\t\t\t\t\t\t\t\t\tfollowing ? 'btn-secondary' : 'btn-outline-secondary'\n\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<i classes={['ion-plus-round']}></i>\n\t\t\t\t\t\t\t\t\t{following ? ' Unfollow ' : ' Follow '}\n\t\t\t\t\t\t\t\t\t{username}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div classes={['container']}>\n\t\t\t\t<div classes={['row']}>\n\t\t\t\t\t<div classes={['col-xs-12', 'col-md-10', 'offset-md-1']}>\n\t\t\t\t\t\t<div classes={['articles-toggle']}>\n\t\t\t\t\t\t\t<ul classes={['nav', 'nav-pills', 'outline-active']}>\n\t\t\t\t\t\t\t\t<li classes={['nav-item']}>\n\t\t\t\t\t\t\t\t\t<ActiveLink\n\t\t\t\t\t\t\t\t\t\tto=\"user\"\n\t\t\t\t\t\t\t\t\t\tclasses={['nav-link']}\n\t\t\t\t\t\t\t\t\t\tparams={{ username }}\n\t\t\t\t\t\t\t\t\t\tactiveClasses={['active']}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tMy Articles\n\t\t\t\t\t\t\t\t\t</ActiveLink>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li classes={['nav-item']}>\n\t\t\t\t\t\t\t\t\t<ActiveLink\n\t\t\t\t\t\t\t\t\t\tto=\"favorites\"\n\t\t\t\t\t\t\t\t\t\tclasses={['nav-link']}\n\t\t\t\t\t\t\t\t\t\tparams={{ username }}\n\t\t\t\t\t\t\t\t\t\tactiveClasses={['active']}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tFavorited Articles\n\t\t\t\t\t\t\t\t\t</ActiveLink>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div classes={['profile-page']}>\n\t\t\t\t\t\t\t{feed.isLoading ? (\n\t\t\t\t\t\t\t\t<div classes={['article-preview']}>Loading... </div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<FeedList type={type} articles={feed.items || []} />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{!feed.isLoading && (\n\t\t\t\t\t\t\t<FeedPagination\n\t\t\t\t\t\t\t\ttotal={total}\n\t\t\t\t\t\t\t\tcurrentPage={currentPage}\n\t\t\t\t\t\t\t\tfetchFeed={(page: number) => {\n\t\t\t\t\t\t\t\t\texecutor(getProfileFeedProcess)({\n\t\t\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\t\t\t\tpage\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n});\n\nexport default Profile;\n"],"sourceRoot":""}